- name: Deploy Report to Pages Branch
  run: |
    git config user.name github-actions
    git config user.email github-actions@github.com
    # Save the generated report to a temporary location
    cp report.html /tmp/report.html
    # Check if the remote 'pages' branch exists; if so, check it out, otherwise create an orphan branch
    if git ls-remote --exit-code origin pages; then
      echo "Pages branch exists. Checking out."
      git checkout pages
      git pull origin pages
    else
      echo "Pages branch does not exist. Creating orphan branch."
      git checkout --orphan pages
    fi
    # Remove all files in the current branch
    git rm -rf . || true
    # Restore the report file and rename it to index.html
    cp /tmp/report.html index.html
    git add index.html
    git commit -m "Deploy updated report to GitHub Pages" || echo "No changes to deploy"
    git push origin pages --force
